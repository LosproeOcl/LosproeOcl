# 图论作业





| 学号：22202170222 |
| ----------------: |
|  **姓名：余青阳** |





------

[TOC]

------







### 最小费用最大流问题

#### 1.作业1

​			**TITLE:求图 1所示网络的最小费用最大流，弧上的第1个数字为单位流的费用,第2个数字为弧的容量。**

<img src="C:\Users\岚天夏\AppData\Roaming\Typora\typora-user-images\image-20230715132112923.png" alt="image-20230715132112923" style="zoom: 50%;" />

##### **STEP 1:先求最大流  (源程序：ANS1.1.1)**

```less
model:
title 最大流;
sets:
  nodes/s,1,2,3,t/;
  arcs(nodes, nodes):  c, f;
endsets

data:
  c = 0 10 8 0 0  
        0 0 0 2 7 
        0 5 0 10 0 
        0 0 0 0 4  
        0 0 0 0 0 ;
enddata

max = flow;
n= @size(nodes);
@for(nodes(i) | i #ne# 1   #and#   i #ne# n:
         @sum(nodes(j): f(i,j)) = @sum(nodes(j):f(j,i)) );

@sum(nodes(i): f(1,i)) = flow;
! @sum(nodes(i): f(i, n)) = flow;
@for(arcs:@bnd(0, f, c));
end

```

###### **运行结果：最大流value==11**

```
  Global optimal solution found.
  Objective value:                              11.00000
  Infeasibilities:                              0.000000
  Total solver iterations:                             3

  Model Class:                                        LP

  Total variables:                     26
  Nonlinear variables:                  0
  Integer variables:                    0

  Total constraints:                    5
  Nonlinear constraints:                0

  Total nonzeros:                      31
  Nonlinear nonzeros:                   0


  Model Title: 最大流
                                Variable           Value        Reduced Cost
                                    FLOW        11.00000            0.000000
                                       N        5.000000            0.000000
                                C( S, S)        0.000000            0.000000
                                C( S, 1)        10.00000            0.000000
                                C( S, 2)        8.000000            0.000000
                                C( S, 3)        0.000000            0.000000
                                C( S, T)        0.000000            0.000000
                                C( 1, S)        0.000000            0.000000
                                C( 1, 1)        0.000000            0.000000
                                C( 1, 2)        0.000000            0.000000
                                C( 1, 3)        2.000000            0.000000
                                C( 1, T)        7.000000            0.000000
                                C( 2, S)        0.000000            0.000000
                                C( 2, 1)        5.000000            0.000000
                                C( 2, 2)        0.000000            0.000000
                                C( 2, 3)        10.00000            0.000000
                                C( 2, T)        0.000000            0.000000
                                C( 3, S)        0.000000            0.000000
                                C( 3, 1)        0.000000            0.000000
                                C( 3, 2)        0.000000            0.000000
                                C( 3, 3)        0.000000            0.000000
                                C( 3, T)        4.000000            0.000000
                                C( T, S)        0.000000            0.000000
                                C( T, 1)        0.000000            0.000000
                                C( T, 2)        0.000000            0.000000
                                C( T, 3)        0.000000            0.000000
                                C( T, T)        0.000000            0.000000
                                F( S, S)        0.000000           -1.000000
                                F( S, 1)        9.000000            0.000000
                                F( S, 2)        2.000000            0.000000
                                F( S, 3)        0.000000            0.000000
                                F( S, T)        0.000000           -1.000000
                                F( 1, S)        0.000000           -1.000000
                                F( 1, 1)        0.000000            0.000000
                                F( 1, 2)        0.000000            0.000000
                                F( 1, 3)        2.000000            0.000000
                                F( 1, T)        7.000000           -1.000000
                                F( 2, S)        0.000000           -1.000000
                                F( 2, 1)        0.000000            0.000000
                                F( 2, 2)        0.000000            0.000000
                                F( 2, 3)        2.000000            0.000000
                                F( 2, T)        0.000000           -1.000000
                                F( 3, S)        0.000000           -1.000000
                                F( 3, 1)        0.000000            0.000000
                                F( 3, 2)        0.000000            0.000000
                                F( 3, 3)        0.000000            0.000000
                                F( 3, T)        4.000000           -1.000000
                                F( T, S)        0.000000            0.000000
                                F( T, 1)        0.000000            1.000000
                                F( T, 2)        0.000000            1.000000
                                F( T, 3)        0.000000            1.000000
                                F( T, T)        0.000000            0.000000
```



##### STEP 2:再求最小费用  (源程序：ANS1.1.2)

```less
MODEL:
Title 最小费用;
    sets:
     nodes/s,1,2,3,t/:d;
     arcs(nodes, nodes)/
          s,1  s,2  1,3  1,t  2,1  2,3   3,t/: c,w, f;
    endsets

    data:
      d = 11    0    0    0  - 11;
	!d的格式：
	最大流的值 0 0 0 0（集合有几个数就用该数减2） 最大流的值的负数;
	 c =  4      1      6     1      2      3      2;
	!c是单位费用;
 	 w =  10    8     2      7     5    10      4;
	!w是边的容量;
     enddata
   min=@sum(arcs:c*f);
  @for(nodes(i) | i #ne# 1 #and# i #ne# @size(nodes):
          @sum(arcs(i,j):f(i,j)) - @sum(arcs(j,i):f(j,i))=d(i)   );
  @sum(arcs(i,j)|i #eq# 1 : f(i,j))=d(1);
  @for(arcs:@bnd(0,f,w));
 END

```

###### **运行结果：最小费用value==55**

```
 Global optimal solution found.
  Objective value:                              55.00000
  Infeasibilities:                              0.000000
  Total solver iterations:                             3

  Model Class:                                        LP

  Total variables:                      7
  Nonlinear variables:                  0
  Integer variables:                    0

  Total constraints:                    5
  Nonlinear constraints:                0

  Total nonzeros:                      19
  Nonlinear nonzeros:                   0


  Model Title: 最小费用
                                Variable           Value        Reduced Cost
                                   D( S)        11.00000            0.000000
                                   D( 1)        0.000000            0.000000
                                   D( 2)        0.000000            0.000000
                                   D( 3)        0.000000            0.000000
                                   D( T)       -11.00000            0.000000
                                C( S, 1)        4.000000            0.000000
                                C( S, 2)        1.000000            0.000000
                                C( 1, 3)        6.000000            0.000000
                                C( 1, T)        1.000000            0.000000
                                C( 2, 1)        2.000000            0.000000
                                C( 2, 3)        3.000000            0.000000
                                C( 3, T)        2.000000            0.000000
                                W( S, 1)        10.00000            0.000000
                                W( S, 2)        8.000000            0.000000
                                W( 1, 3)        2.000000            0.000000
                                W( 1, T)        7.000000            0.000000
                                W( 2, 1)        5.000000            0.000000
                                W( 2, 3)        10.00000            0.000000
                                W( 3, T)        4.000000            0.000000
                                F( S, 1)        3.000000            0.000000
                                F( S, 2)        8.000000           -1.000000
                                F( 1, 3)        0.000000            5.000000
                                F( 1, T)        7.000000           -2.000000
                                F( 2, 1)        4.000000            0.000000
                                F( 2, 3)        4.000000            0.000000
                                F( 3, T)        4.000000            
```



#### 2.作业2

​			**TITLE:表1所列是某运输问题的相关数据。将此问题转化为最小费用最大流问题，画出网络图并求解。**

<img src="C:\Users\岚天夏\AppData\Roaming\Typora\typora-user-images\image-20230715132359573.png" alt="image-20230715132359573" style="zoom:50%;" />

​		解：为了使用最大流算法，必须构造单源单汇的网络，加一个虚拟的源点vs，一个虚拟的汇点vt

##### STEP 1:利用matlab绘制网络图

​		令:[VS,VT]==[1,7];产地[A,B]==[2,3];销地[1,2,3]==[4,5,6];

matlab源代码为：

```matlab
clc;clear all;
s = [1 1 2 2 2 3 3 3 4 5 6];
t = [2 3 4 5 6 4 5 6 7 7 7];
weights = [8 7 8 8 8 7 7 7 4 5 6];
G = digraph(s,t,weights);
mf=maxflow(G,1,6)
plot(G,'EdgeLabel',G.Edges.Weight,'Layout','layered');
```

<img src="C:\Users\岚天夏\Desktop\学习资料\图论\22202170222_余青阳\源程序\Graph_1.2.1.png" alt="Graph_1.2.1" style="zoom:75%;" />

得到的网络图如图所示，其中弧旁的第一个数字为单位流的费用，第二个数字表示容量。



##### STEP 2:LINGO求最大流 （源程序：ANS1.2.1)

​		求出最大流的流量为 15。可以建立线性规划模型求解，求解的 Lingo 程序如下：

```less
model:
title 最大流;
sets:
  nodes/s,A,B,1,2,3,t/;
  arcs(nodes, nodes):  c, f;
endsets

data:
c = 0 8 7 0 0 0 0
	0 0 0 8 8 8 0
	0 0 0 7 7 7 0
	0 0 0 0 0 0 4
	0 0 0 0 0 0 5
	0 0 0 0 0 0 6
	0 0 0 0 0 0 0;
enddata

max = flow;
n= @size(nodes);
@for(nodes(i) | i #ne# 1   #and#   i #ne# n:
         @sum(nodes(j): f(i,j)) = @sum(nodes(j):f(j,i)) );

@sum(nodes(i): f(1,i)) = flow;
! @sum(nodes(i): f(i, n)) = flow;
@for(arcs:@bnd(0, f, c));
end
```

###### 运行结果：最大流value==15

```
 Global optimal solution found.
  Objective value:                              15.00000
  Infeasibilities:                              0.000000
  Total solver iterations:                             5

  Model Class:                                        LP

  Total variables:                     50
  Nonlinear variables:                  0
  Integer variables:                    0

  Total constraints:                    7
  Nonlinear constraints:                0

  Total nonzeros:                      69
  Nonlinear nonzeros:                   0


  Model Title: 最大流
                                Variable           Value        Reduced Cost
                                    FLOW        15.00000            0.000000
                                       N        7.000000            0.000000
                                C( S, S)        0.000000            0.000000
                                C( S, A)        8.000000            0.000000
                                C( S, B)        7.000000            0.000000
                                C( S, 1)        0.000000            0.000000
                                C( S, 2)        0.000000            0.000000
                                C( S, 3)        0.000000            0.000000
                                C( S, T)        0.000000            0.000000
                                C( A, S)        0.000000            0.000000
                                C( A, A)        0.000000            0.000000
                                C( A, B)        0.000000            0.000000
                                C( A, 1)        8.000000            0.000000
                                C( A, 2)        8.000000            0.000000
                                C( A, 3)        8.000000            0.000000
                                C( A, T)        0.000000            0.000000
                                C( B, S)        0.000000            0.000000
                                C( B, A)        0.000000            0.000000
                                C( B, B)        0.000000            0.000000
                                C( B, 1)        7.000000            0.000000
                                C( B, 2)        7.000000            0.000000
                                C( B, 3)        7.000000            0.000000
                                C( B, T)        0.000000            0.000000
                                C( 1, S)        0.000000            0.000000
                                C( 1, A)        0.000000            0.000000
                                C( 1, B)        0.000000            0.000000
                                C( 1, 1)        0.000000            0.000000
                                C( 1, 2)        0.000000            0.000000
                                C( 1, 3)        0.000000            0.000000
                                C( 1, T)        4.000000            0.000000
                                C( 2, S)        0.000000            0.000000
                                C( 2, A)        0.000000            0.000000
                                C( 2, B)        0.000000            0.000000
                                C( 2, 1)        0.000000            0.000000
                                C( 2, 2)        0.000000            0.000000
                                C( 2, 3)        0.000000            0.000000
                                C( 2, T)        5.000000            0.000000
                                C( 3, S)        0.000000            0.000000
                                C( 3, A)        0.000000            0.000000
                                C( 3, B)        0.000000            0.000000
                                C( 3, 1)        0.000000            0.000000
                                C( 3, 2)        0.000000            0.000000
                                C( 3, 3)        0.000000            0.000000
                                C( 3, T)        6.000000            0.000000
                                C( T, S)        0.000000            0.000000
                                C( T, A)        0.000000            0.000000
                                C( T, B)        0.000000            0.000000
                                C( T, 1)        0.000000            0.000000
                                C( T, 2)        0.000000            0.000000
                                C( T, 3)        0.000000            0.000000
                                C( T, T)        0.000000            0.000000
                                F( S, S)        0.000000           -1.000000
                                F( S, A)        8.000000           -1.000000
                                F( S, B)        7.000000           -1.000000
                                F( S, 1)        0.000000           -1.000000
                                F( S, 2)        0.000000           -1.000000
                                F( S, 3)        0.000000           -1.000000
                                F( S, T)        0.000000           -1.000000
                                F( A, S)        0.000000            0.000000
                                F( A, A)        0.000000            0.000000
                                F( A, B)        0.000000            0.000000
                                F( A, 1)        3.000000            0.000000
                                F( A, 2)        5.000000            0.000000
                                F( A, 3)        0.000000            0.000000
                                F( A, T)        0.000000            0.000000
                                F( B, S)        0.000000            0.000000
                                F( B, A)        0.000000            0.000000
                                F( B, B)        0.000000            0.000000
                                F( B, 1)        1.000000            0.000000
                                F( B, 2)        0.000000            0.000000
                                F( B, 3)        6.000000            0.000000
                                F( B, T)        0.000000            0.000000
                                F( 1, S)        0.000000            0.000000
                                F( 1, A)        0.000000            0.000000
                                F( 1, B)        0.000000            0.000000
                                F( 1, 1)        0.000000            0.000000
                                F( 1, 2)        0.000000            0.000000
                                F( 1, 3)        0.000000            0.000000
                                F( 1, T)        4.000000            0.000000
                                F( 2, S)        0.000000            0.000000
                                F( 2, A)        0.000000            0.000000
                                F( 2, B)        0.000000            0.000000
                                F( 2, 1)        0.000000            0.000000
                                F( 2, 2)        0.000000            0.000000
                                F( 2, 3)        0.000000            0.000000
                                F( 2, T)        5.000000            0.000000
                                F( 3, S)        0.000000            0.000000
                                F( 3, A)        0.000000            0.000000
                                F( 3, B)        0.000000            0.000000
                                F( 3, 1)        0.000000            0.000000
                                F( 3, 2)        0.000000            0.000000
                                F( 3, 3)        0.000000            0.000000
                                F( 3, T)        6.000000            0.000000
                                F( T, S)        0.000000            0.000000
                                F( T, A)        0.000000            0.000000
                                F( T, B)        0.000000            0.000000
                                F( T, 1)        0.000000            0.000000
                                F( T, 2)        0.000000            0.000000
                                F( T, 3)        0.000000            0.000000
                                F( T, T)        0.000000  
```



##### STEP 3 :再求最小费用（源程序：ANS1.2.2)

```less
MODEL:
Title 最小费用;
    sets:
     nodes/s,A,B,1,2,3,t/:d;
     arcs(nodes, nodes)/
          s,A  s,B  A,1  A,2  A,3  B,1  B,2  B,3  1,t  2,t  3,t /: c,w, f;
    endsets

    data:
      d = 15   0    0    0    0    0  - 15;
	!d的格式：
	最大流的值 0 0 0 0（集合有几个数就用该数减2） 最大流的值的负数;
      c =  0  0  20  24  5  30  22  20  0 0 0;
	!c是单位费用;
      w =  8  7  8  8  8  7  7  7  4  5  6 ;
	!w是边的容量;
     enddata
   min=@sum(arcs:c*f);
  @for(nodes(i) | i #ne# 1 #and# i #ne# @size(nodes):
          @sum(arcs(i,j):f(i,j)) - @sum(arcs(j,i):f(j,i))=d(i)   );
  @sum(arcs(i,j)|i #eq# 1 : f(i,j))=d(1);
  @for(arcs:@bnd(0,f,w));
 END

```

###### **运行结果：最小费用value==240**

```
  Global optimal solution found.
  Objective value:                              240.0000
  Infeasibilities:                              0.000000
  Total solver iterations:                             6

  Model Class:                                        LP

  Total variables:                     11
  Nonlinear variables:                  0
  Integer variables:                    0

  Total constraints:                    7
  Nonlinear constraints:                0

  Total nonzeros:                      25
  Nonlinear nonzeros:                   0


  Model Title: 最小费用
```



#### 3.作业3

​			**TITLE:某单位招收懂俄、英、日、德、法文的翻译各一人,有5人应聘。已知乙懂俄文,甲、乙、丙、丁懂英文,甲、丙、丁懂日文,乙、戊懂德文，戊懂法文,问这5个人是否都能得到聘书?最多几个得到聘书，招聘后每人从事哪一方面翻译工作?**



##### STEP 1:由题绘制表格

|      | 俄   | 英   | 日   | 德   | 法   |
| ---- | ---- | ---- | ---- | ---- | ---- |
| 甲   |      | 1    | 1    |      |      |
| 乙   | 1    | 1    |      | 1    |      |
| 丙   |      | 1    | 1    |      |      |
| 丁   |      | 1    | 1    |      |      |
| 戊   |      |      |      | 1    | 1    |

##### STEP 2:问题分析与结果分析

​		由表格易知：有且仅有**乙会俄语**、有且仅有**戊会法语**，故俄语翻译必须招收乙，法语翻译必须招收戊，即此时乙、戊各至少获得一门聘书，且俄语和法语翻译不再招收其他员工。（此时已有两位员工被录用）

​		其次，**有且仅有乙和戊会德语**，故**德语翻译必然在其二者中产生**，当**乙或戊其中一人被招聘**为德语翻译，则**该职位不另招收**。（此时仍然仅有两位员工被录用）

​		再次，**甲丙丁（共3人）均会且仅会英语和日语**，而**空余职位剩且剩英语和日语翻译各一名（共2名）**，故在乙不竞聘该职位的情况下，**此三人至多聘用两人**，剩余一人落选所有职位，故包括上述已经被录用的两名员工，**此五人中最多四人被聘用，故不是5人都可以得到聘书**。

​		由表格，除乙会三门翻译外，其他人均会且仅会两门翻译，所以单人获得聘书不超过三门，当且仅当乙所会项目均可以受聘用，则单人聘书门数取得3。当不要求聘用人数达到最大时，该值取得3，且此时有两个人不被录用；当招聘人数要求达到最大（4人录用）则单人至多受聘两门，且只在乙和戊中产生，谁取得德语翻译评述谁为最大；





#### 4.作业4

​			**TITLE:某产品从仓库运往市场销售。已知各仓库的可供量、各市场需求量及从i仓库至j市场的路径的运输能力如表2所列(表中数字0代表无路可通)，试求从仓库可运往市场的最大流量,各市场需求能否满足?**         

<img src="C:\Users\岚天夏\AppData\Roaming\Typora\typora-user-images\image-20230715132614163.png" alt="image-20230715132614163" style="zoom:50%;" />

##### STEP 1:LINGO求最大流 （源程序：ANS1.4.1)

```LESS
model:
title 最大流;
sets:
  nodes/s,A,B,C,1,2,3,4,t/;
  arcs(nodes, nodes):  c, f;
endsets

data:
      c = 20 20 100 0 0   0   0  0  0
	0   0     0    0 30 10 0 40 0
	0   0     0    0 0    0 10 50 0
	0   0     0    0  20 10  40 5 0
	0   0     0    0  0 0 0 0 20
	0 0 0 0 0 0 0 0 20
	0 0 0 0 0 0 0 0 60
	0 0 0 0 0 0 0 0 20
	0 0 0 0 0 0 0 0 0;
enddata

max = flow;
n= @size(nodes);
@for(nodes(i) | i #ne# 1   #and#   i #ne# n:
         @sum(nodes(j): f(i,j)) = @sum(nodes(j):f(j,i)) );

@sum(nodes(i): f(1,i)) = flow;
! @sum(nodes(i): f(i, n)) = flow;
@for(arcs:@bnd(0, f, c));
end



```



###### 运行结果：最大流value==70

```
Global optimal solution found.
  Objective value:                              70.00000
  Infeasibilities:                              0.000000
  Total solver iterations:                             3

  Model Class:                                        LP

  Total variables:                     82
  Nonlinear variables:                  0
  Integer variables:                    0

  Total constraints:                    9
  Nonlinear constraints:                0

  Total nonzeros:                     123
  Nonlinear nonzeros:                   0


  Model Title: 最大流
                                Variable           Value        Reduced Cost
                                    FLOW        70.00000            0.000000
                                       N        9.000000            0.000000
                                C( S, S)        20.00000            0.000000
                                C( S, A)        20.00000            0.000000
                                C( S, B)        100.0000            0.000000
                                C( S, C)        0.000000            0.000000
                                C( S, 1)        0.000000            0.000000
                                C( S, 2)        0.000000            0.000000
                                C( S, 3)        0.000000            0.000000
                                C( S, 4)        0.000000            0.000000
                                C( S, T)        0.000000            0.000000
                                C( A, S)        0.000000            0.000000
                                C( A, A)        0.000000            0.000000
                                C( A, B)        0.000000            0.000000
                                C( A, C)        0.000000            0.000000
                                C( A, 1)        30.00000            0.000000
                                C( A, 2)        10.00000            0.000000
                                C( A, 3)        0.000000            0.000000
                                C( A, 4)        40.00000            0.000000
                                C( A, T)        0.000000            0.000000
                                C( B, S)        0.000000            0.000000
                                C( B, A)        0.000000            0.000000
                                C( B, B)        0.000000            0.000000
                                C( B, C)        0.000000            0.000000
                                C( B, 1)        0.000000            0.000000
                                C( B, 2)        0.000000            0.000000
                                C( B, 3)        10.00000            0.000000
                                C( B, 4)        50.00000            0.000000
                                C( B, T)        0.000000            0.000000
                                C( C, S)        0.000000            0.000000
                                C( C, A)        0.000000            0.000000
                                C( C, B)        0.000000            0.000000
                                C( C, C)        0.000000            0.000000
                                C( C, 1)        20.00000            0.000000
                                C( C, 2)        10.00000            0.000000
                                C( C, 3)        40.00000            0.000000
                                C( C, 4)        5.000000            0.000000
                                C( C, T)        0.000000            0.000000
                                C( 1, S)        0.000000            0.000000
                                C( 1, A)        0.000000            0.000000
                                C( 1, B)        0.000000            0.000000
                                C( 1, C)        0.000000            0.000000
                                C( 1, 1)        0.000000            0.000000
                                C( 1, 2)        0.000000            0.000000
                                C( 1, 3)        0.000000            0.000000
                                C( 1, 4)        0.000000            0.000000
                                C( 1, T)        20.00000            0.000000
                                C( 2, S)        0.000000            0.000000
                                C( 2, A)        0.000000            0.000000
                                C( 2, B)        0.000000            0.000000
                                C( 2, C)        0.000000            0.000000
                                C( 2, 1)        0.000000            0.000000
                                C( 2, 2)        0.000000            0.000000
                                C( 2, 3)        0.000000            0.000000
                                C( 2, 4)        0.000000            0.000000
                                C( 2, T)        20.00000            0.000000
                                C( 3, S)        0.000000            0.000000
                                C( 3, A)        0.000000            0.000000
                                C( 3, B)        0.000000            0.000000
                                C( 3, C)        0.000000            0.000000
                                C( 3, 1)        0.000000            0.000000
                                C( 3, 2)        0.000000            0.000000
                                C( 3, 3)        0.000000            0.000000
                                C( 3, 4)        0.000000            0.000000
                                C( 3, T)        60.00000            0.000000
                                C( 4, S)        0.000000            0.000000
                                C( 4, A)        0.000000            0.000000
                                C( 4, B)        0.000000            0.000000
                                C( 4, C)        0.000000            0.000000
                                C( 4, 1)        0.000000            0.000000
                                C( 4, 2)        0.000000            0.000000
                                C( 4, 3)        0.000000            0.000000
                                C( 4, 4)        0.000000            0.000000
                                C( 4, T)        20.00000            0.000000
                                C( T, S)        0.000000            0.000000
                                C( T, A)        0.000000            0.000000
                                C( T, B)        0.000000            0.000000
                                C( T, C)        0.000000            0.000000
                                C( T, 1)        0.000000            0.000000
                                C( T, 2)        0.000000            0.000000
                                C( T, 3)        0.000000            0.000000
                                C( T, 4)        0.000000            0.000000
                                C( T, T)        0.000000            0.000000
                                F( S, S)        20.00000           -1.000000
                                F( S, A)        20.00000           -1.000000
                                F( S, B)        30.00000            0.000000
                                F( S, C)        0.000000           -1.000000
                                F( S, 1)        0.000000           -1.000000
                                F( S, 2)        0.000000           -1.000000
                                F( S, 3)        0.000000           -1.000000
                                F( S, 4)        0.000000            0.000000
                                F( S, T)        0.000000           -1.000000
                                F( A, S)        0.000000            0.000000
                                F( A, A)        0.000000            0.000000
                                F( A, B)        0.000000            1.000000
                                F( A, C)        0.000000            0.000000
                                F( A, 1)        10.00000            0.000000
                                F( A, 2)        10.00000            0.000000
                                F( A, 3)        0.000000            0.000000
                                F( A, 4)        0.000000            1.000000
                                F( A, T)        0.000000            0.000000
                                F( B, S)        0.000000           -1.000000
                                F( B, A)        0.000000           -1.000000
                                F( B, B)        0.000000            0.000000
                                F( B, C)        0.000000           -1.000000
                                F( B, 1)        0.000000           -1.000000
                                F( B, 2)        0.000000           -1.000000
                                F( B, 3)        10.00000           -1.000000
                                F( B, 4)        20.00000            0.000000
                                F( B, T)        0.000000           -1.000000
                                F( C, S)        0.000000            0.000000
                                F( C, A)        0.000000            0.000000
                                F( C, B)        0.000000            1.000000
                                F( C, C)        0.000000            0.000000
                                F( C, 1)        0.000000            0.000000
                                F( C, 2)        0.000000            0.000000
                                F( C, 3)        0.000000            0.000000
                                F( C, 4)        0.000000            1.000000
                                F( C, T)        0.000000            0.000000
                                F( 1, S)        0.000000            0.000000
                                F( 1, A)        0.000000            0.000000
                                F( 1, B)        0.000000            1.000000
                                F( 1, C)        0.000000            0.000000
                                F( 1, 1)        0.000000            0.000000
                                F( 1, 2)        0.000000            0.000000
                                F( 1, 3)        0.000000            0.000000
                                F( 1, 4)        0.000000            1.000000
                                F( 1, T)        10.00000            0.000000
                                F( 2, S)        0.000000            0.000000
                                F( 2, A)        0.000000            0.000000
                                F( 2, B)        0.000000            1.000000
                                F( 2, C)        0.000000            0.000000
                                F( 2, 1)        0.000000            0.000000
                                F( 2, 2)        0.000000            0.000000
                                F( 2, 3)        0.000000            0.000000
                                F( 2, 4)        0.000000            1.000000
                                F( 2, T)        10.00000            0.000000
                                F( 3, S)        0.000000            0.000000
                                F( 3, A)        0.000000            0.000000
                                F( 3, B)        0.000000            1.000000
                                F( 3, C)        0.000000            0.000000
                                F( 3, 1)        0.000000            0.000000
                                F( 3, 2)        0.000000            0.000000
                                F( 3, 3)        0.000000            0.000000
                                F( 3, 4)        0.000000            1.000000
                                F( 3, T)        10.00000            0.000000
                                F( 4, S)        0.000000           -1.000000
                                F( 4, A)        0.000000           -1.000000
                                F( 4, B)        0.000000            0.000000
                                F( 4, C)        0.000000           -1.000000
                                F( 4, 1)        0.000000           -1.000000
                                F( 4, 2)        0.000000           -1.000000
                                F( 4, 3)        0.000000           -1.000000
                                F( 4, 4)        0.000000            0.000000
                                F( 4, T)        20.00000           -1.000000
                                F( T, S)        0.000000            0.000000
                                F( T, A)        0.000000            0.000000
                                F( T, B)        0.000000            1.000000
                                F( T, C)        0.000000            0.000000
                                F( T, 1)        0.000000            0.000000
                                F( T, 2)        0.000000            0.000000
                                F( T, 3)        0.000000            0.000000
                                F( T, 4)        0.000000            1.000000
                                F( T, T)        0.000000          
```



### 最小生成树问题



#### 1.作业1

​			**TITLE:**

<img src="C:\Users\岚天夏\AppData\Roaming\Typora\typora-user-images\image-20230715132733279.png" alt="image-20230715132733279" style="zoom:50%;" />

##### FIRST WAY:用matlab使用Kruskal算法求最小生成树

```matlab
Matlab程序如下：
clc;clear;
a(1,2)=50;a(1,3)=60;a(2,4)=65;a(2,5)=40;a(3,4)=52;
a(3,7)=45;a(4,5)=50;a(4,6)=30;a(4,7)=42;a(5,6)=70;
[i,j,b]=find(a);
data=[i';j';b'];index=data(1:2,:);
loop=length(a)-1;
result=[ ];
while length(result)<loop
   temp=min(data(3,:));
   flag=find(data(3,:)==temp);
    flag=flag(1);
   v1=index(1,flag);v2=index(2,flag);
   if v1~=v2
    result=[result,data(:,flag)];
    end
   index(find(index==v2))=v1;
   data(:,flag)=[ ]
   index(:,flag)=[ ];
end
result
```

###### 结果分析

```matlab
data =1     1     2     3     2     4     5     3     4
          2     3     4     4     5     5     6     7     7
          50    60    65    52    40    50    70    45    42

data = 1       1      2      3      4      5      3      4
           2       3      4      4      5      6      7      7
          50    60     65    52    50    70    45    42

data =1     1      2      3      4      5      3
          2     3      4      4      5      6      7
         50    60    65    52    50    70    45

data =1      1      2      3      4      5
           2      3     4      4      5      6
          50    60    65    52    50    70

data =1     2      3      4        5
          3     4      4      5        6
         60    65    52    50    70

data =1      2      3      5
          3      4      4      6
         60    65    52    70


result =  4      2      4       3      1      4
              6      5      7       7      2      5
             30    40    42     45     50    50

```



##### SECOND WAY:避圈法

​     从网络图中依次寻找权数较小的边，寻找过程中，节点不得重复，即不得构成圈。注意在找较小权数的边时不考虑已选过的边和可能造成圈的边。如此反复进行，直到得到最短树。





#### 2.作业2

​			**TITLE:北京(Pe)、东京(T)、纽约(N)、墨西哥城(M)、伦敦(L)、巴黎(Pa)各城市之间的航线距离如表1所示。由下面的交通网络的数据确定最小生成树。**

<img src="C:\Users\岚天夏\AppData\Roaming\Typora\typora-user-images\image-20230715133034526.png" alt="image-20230715133034526" style="zoom:50%;" />

##### STEP 1:LINGO求最小生成树  （源程序：ANS2.2.1）

```less
Model:
sets:
  cities/1..6/:u;      
  link(cities, cities): d, x;      
endsets
data:              
   d =0 56 35 21 51 60
	56 0 21 57 78 70
	35 21 0 36 68 68
	21 57 36 0 51 61
	51 78 68 51 0 13
	60 70 68 61 13 0;     
enddata
n=@size(cities); 
min=@sum(link(i,j): d(i,j)*x(i,j));
@sum(cities(j)|j#ne#1:x(1,j))>1;
@for(cities(i)| i #gt# 1: @sum(cities(j)| j #ne# i:x(j,i))=1 );
@for(link : @bin(x) );
@for(cities: u<n);  @for(cities: u>1);
@for(link(i,j)|i #ne# j : u(i)-u(j)+n*x(i,j)<n-1);
end
```

###### 结果分析：最短路径value==141

```
  Global optimal solution found.
  Objective value:                              141.0000
  Objective bound:                              141.0000
  Infeasibilities:                              0.000000
  Extended solver steps:                               0
  Total solver iterations:                            38

  Model Class:                                      MILP

  Total variables:                     42
  Nonlinear variables:                  0
  Integer variables:                   36

  Total constraints:                   49
  Nonlinear constraints:                0

  Total nonzeros:                     162
  Nonlinear nonzeros:                   0

                                Variable           Value        Reduced Cost
                                       N        6.000000            0.000000
                                   U( 1)        1.000000            0.000000
                                   U( 2)        6.000000            0.000000
                                   U( 3)        2.000000            0.000000
                                   U( 4)        2.000000            0.000000
                                   U( 5)        2.000000            0.000000
                                   U( 6)        3.000000            0.000000
                                D( 1, 1)        0.000000            0.000000
                                D( 1, 2)        56.00000            0.000000
                                D( 1, 3)        35.00000            0.000000
                                D( 1, 4)        21.00000            0.000000
                                D( 1, 5)        51.00000            0.000000
                                D( 1, 6)        60.00000            0.000000
                                D( 2, 1)        56.00000            0.000000
                                D( 2, 2)        0.000000            0.000000
                                D( 2, 3)        21.00000            0.000000
                                D( 2, 4)        57.00000            0.000000
                                D( 2, 5)        78.00000            0.000000
                                D( 2, 6)        70.00000            0.000000
                                D( 3, 1)        35.00000            0.000000
                                D( 3, 2)        21.00000            0.000000
                                D( 3, 3)        0.000000            0.000000
                                D( 3, 4)        36.00000            0.000000
                                D( 3, 5)        68.00000            0.000000
                                D( 3, 6)        68.00000            0.000000
                                D( 4, 1)        21.00000            0.000000
                                D( 4, 2)        57.00000            0.000000
                                D( 4, 3)        36.00000            0.000000
                                D( 4, 4)        0.000000            0.000000
                                D( 4, 5)        51.00000            0.000000
                                D( 4, 6)        61.00000            0.000000
                                D( 5, 1)        51.00000            0.000000
                                D( 5, 2)        78.00000            0.000000
                                D( 5, 3)        68.00000            0.000000
                                D( 5, 4)        51.00000            0.000000
                                D( 5, 5)        0.000000            0.000000
                                D( 5, 6)        13.00000            0.000000
                                D( 6, 1)        60.00000            0.000000
                                D( 6, 2)        70.00000            0.000000
                                D( 6, 3)        68.00000            0.000000
                                D( 6, 4)        61.00000            0.000000
                                D( 6, 5)        13.00000            0.000000
                                D( 6, 6)        0.000000            0.000000
                                X( 1, 1)        0.000000            0.000000
                                X( 1, 2)        0.000000            56.00000
                                X( 1, 3)        1.000000            35.00000
                                X( 1, 4)        1.000000            21.00000
                                X( 1, 5)        1.000000            51.00000
                                X( 1, 6)        0.000000            60.00000
                                X( 2, 1)        0.000000            56.00000
                                X( 2, 2)        0.000000            0.000000
                                X( 2, 3)        0.000000            21.00000
                                X( 2, 4)        0.000000            57.00000
                                X( 2, 5)        0.000000            78.00000
                                X( 2, 6)        0.000000            70.00000
                                X( 3, 1)        0.000000            35.00000
                                X( 3, 2)        1.000000            21.00000
                                X( 3, 3)        0.000000            0.000000
                                X( 3, 4)        0.000000            36.00000
                                X( 3, 5)        0.000000            68.00000
                                X( 3, 6)        0.000000            68.00000
                                X( 4, 1)        0.000000            21.00000
                                X( 4, 2)        0.000000            57.00000
                                X( 4, 3)        0.000000            36.00000
                                X( 4, 4)        0.000000            0.000000
                                X( 4, 5)        0.000000            51.00000
                                X( 4, 6)        0.000000            61.00000
                                X( 5, 1)        0.000000            51.00000
                                X( 5, 2)        0.000000            78.00000
                                X( 5, 3)        0.000000            68.00000
                                X( 5, 4)        0.000000            51.00000
                                X( 5, 5)        0.000000            0.000000
                                X( 5, 6)        1.000000            13.00000
                                X( 6, 1)        0.000000            60.00000
                                X( 6, 2)        0.000000            70.00000
                                X( 6, 3)        0.000000            68.00000
                                X( 6, 4)        0.000000            61.00000
                                X( 6, 5)        0.000000            13.00000
                                X( 6, 6)        0.000000            0.000000

                                     Row    Slack or Surplus      Dual Price
                                       1        0.000000            0.000000
                                       2        141.0000           -1.000000
                                       3        2.000000            0.000000
                                       4        0.000000            0.000000
                                       5        0.000000            0.000000
                                       6        0.000000            0.000000
                                       7        0.000000            0.000000
                                       8        0.000000            0.000000
                                       9        5.000000            0.000000
                                      10        0.000000            0.000000
                                      11        4.000000            0.000000
                                      12        4.000000            0.000000
                                      13        4.000000            0.000000
                                      14        3.000000            0.000000
                                      15        0.000000            0.000000
                                      16        5.000000            0.000000
                                      17        1.000000            0.000000
                                      18        1.000000            0.000000
                                      19        1.000000            0.000000
                                      20        2.000000            0.000000
                                      21        10.00000            0.000000
                                      22        0.000000            0.000000
                                      23        0.000000            0.000000
                                      24        0.000000            0.000000
                                      25        7.000000            0.000000
                                      26        0.000000            0.000000
                                      27        1.000000            0.000000
                                      28        1.000000            0.000000
                                      29        1.000000            0.000000
                                      30        2.000000            0.000000
                                      31        4.000000            0.000000
                                      32        3.000000            0.000000
                                      33        5.000000            0.000000
                                      34        5.000000            0.000000
                                      35        6.000000            0.000000
                                      36        4.000000            0.000000
                                      37        9.000000            0.000000
                                      38        5.000000            0.000000
                                      39        5.000000            0.000000
                                      40        6.000000            0.000000
                                      41        4.000000            0.000000
                                      42        9.000000            0.000000
                                      43        5.000000            0.000000
                                      44        5.000000            0.000000
                                      45        0.000000            0.000000
                                      46        3.000000            0.000000
                                      47        8.000000            0.000000
                                      48        4.000000            0.000000
                                      49        4.000000            0.000000
                                      50        4.000000            0.000000
```

